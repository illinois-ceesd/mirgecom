
import numpy as np

class gas_properties():
    """ Simplified model of the pyrolysis gas.

        This section is to be used when species conservation is not employed.
        The output gas is assumed to be in chemical equilibrium."""

    def __init__(self, Pr=1.0, Le=1.0):

        self._prandtl = Pr
        self._lewis = Le

        #    T     , M       ,  Cp    , gamma  ,  enthalpy,  viscosity, density
        gas = np.array([
            [200.00,  21.9960,  1.5119,  1.3334,  -7246.50,  0.086881,  1.340300],
            [225.00,  21.9960,  1.5336,  1.3271,  -7208.40,  0.096663,  1.191300],
            [250.00,  21.9960,  1.5597,  1.3199,  -7169.80,  0.106450,  1.072200],
            [275.00,  21.9960,  1.5921,  1.3114,  -7130.40,  0.116150,  0.974730],
            [300.00,  21.9960,  1.6308,  1.3018,  -7090.10,  0.125720,  0.893500],
            [325.00,  21.9960,  1.6755,  1.2914,  -7048.80,  0.135140,  0.824770],
            [350.00,  21.9950,  1.7259,  1.2807,  -7006.30,  0.144380,  0.765840],
            [375.00,  21.9940,  1.7826,  1.2697,  -6962.50,  0.153440,  0.714750],
            [400.00,  21.9920,  1.8467,  1.2587,  -6917.10,  0.162320,  0.670020],
            [425.00,  21.9880,  1.9205,  1.2475,  -6870.00,  0.171020,  0.630490],
            [450.00,  21.9810,  2.0075,  1.2362,  -6821.00,  0.179550,  0.595260],
            [475.00,  21.9680,  2.1124,  1.2248,  -6769.50,  0.187920,  0.563610],
            [500.00,  21.9480,  2.2411,  1.2133,  -6715.20,  0.196150,  0.534940],
            [525.00,  21.9170,  2.4018,  1.2018,  -6657.20,  0.204240,  0.508740],
            [550.00,  21.8700,  2.6053,  1.1902,  -6594.70,  0.212210,  0.484590],
            [575.00,  21.8040,  2.8670,  1.1786,  -6526.50,  0.220070,  0.462120],
            [600.00,  21.7120,  3.2102,  1.1670,  -6450.70,  0.227850,  0.441000],
            [625.00,  21.5870,  3.6707,  1.1554,  -6365.00,  0.235560,  0.420910],
            [650.00,  21.4180,  4.3012,  1.1440,  -6265.70,  0.243230,  0.401550],
            [675.00,  21.1910,  5.1709,  1.1333,  -6147.90,  0.250890,  0.382590],
            [700.00,  20.8900,  6.3506,  1.1242,  -6004.60,  0.258610,  0.363680],
            [725.00,  20.4950,  7.8823,  1.1174,  -5827.40,  0.266440,  0.344490],
            [750.00,  19.9900,  9.7476,  1.1131,  -5607.70,  0.274430,  0.324800],
            [775.00,  19.3690,  11.8540,  1.1113,  -5338.00,  0.282610,  0.304570],
            [800.00,  18.6440,  14.0290,  1.1116,  -5014.40,  0.290920,  0.284000],
            [825.00,  17.8400,  16.0100,  1.1136,  -4638.20,  0.299300,  0.263530],
            [850.00,  17.0040,  17.4370,  1.1171,  -4218.50,  0.307610,  0.243780],
            [875.00,  16.1900,  17.8870,  1.1219,  -3774.50,  0.315710,  0.225480],
            [900.00,  15.4570,  17.0090,  1.1283,  -3335.30,  0.323490,  0.209290],
            [925.00,  14.8550,  14.7650,  1.1364,  -2935.60,  0.330860,  0.195700],
            [950.00,  14.4100,  11.6470,  1.1473,  -2604.50,  0.337800,  0.184850],
            [975.00,  14.1190,  8.5576,  1.1620,  -2352.90,  0.344350,  0.176470],
            [1000.00,  13.9470,  6.2218,  1.1804,  -2170.10,  0.350600,  0.169970],
            [1025.00,  13.8540,  4.7840,  1.1992,  -2034.20,  0.356630,  0.164710],
            [1050.00,  13.8040,  4.0135,  1.2138,  -1925.40,  0.362500,  0.160220],
            [1075.00,  13.7780,  3.6439,  1.2220,  -1830.30,  0.368280,  0.156190],
            [1100.00,  13.7630,  3.5092,  1.2240,  -1741.20,  0.373980,  0.152480],
            [1125.00,  13.7520,  3.5606,  1.2202,  -1653.30,  0.379650,  0.148970],
            [1150.00,  13.7370,  3.9008,  1.2087,  -1560.90,  0.385360,  0.145570],
            [1175.00,  13.7060,  4.8067,  1.1899,  -1453.50,  0.391330,  0.142150],
            [1200.00,  13.6390,  6.2353,  1.1737,  -1315.90,  0.397930,  0.138510],
            [1225.00,  13.5310,  7.4468,  1.1662,  -1143.80,  0.405280,  0.134610],
            [1250.00,  13.3990,  8.1396,  1.1638,  -947.97,  0.413140,  0.130630],
            [1275.00,  13.2560,  8.4790,  1.1633,  -739.70,  0.421190,  0.126700],
            [1300.00,  13.1120,  8.6336,  1.1633,  -525.54,  0.429240,  0.122920],
            [1325.00,  12.9710,  8.7074,  1.1631,  -308.69,  0.437140,  0.119300],
            [1350.00,  12.8360,  8.7669,  1.1624,  -90.28,  0.444780,  0.115870],
            [1375.00,  12.7060,  8.8600,  1.1608,  129.94,  0.452050,  0.112610],
            [1400.00,  12.5800,  9.0239,  1.1583,  353.31,  0.458870,  0.109510],
            [1425.00,  12.4590,  9.2883,  1.1548,  581.98,  0.465140,  0.106550],
            [1450.00,  12.3410,  9.6744,  1.1506,  818.74,  0.470780,  0.103720],
            [1475.00,  12.2230,  10.1900,  1.1460,  1066.80,  0.475700,  0.100980],
            [1500.00,  12.1030,  10.8220,  1.1415,  1329.20,  0.479860,  0.098332],
            [1525.00,  11.9820,  11.5160,  1.1377,  1608.40,  0.483230,  0.095748],
            [1550.00,  11.8570,  12.1540,  1.1352,  1904.60,  0.485880,  0.093226],
            [1575.00,  11.7320,  12.5310,  1.1349,  2214.00,  0.487980,  0.090775],
            [1600.00,  11.6090,  12.3770,  1.1377,  2526.70,  0.489850,  0.088420],
            [1625.00,  11.4950,  11.5140,  1.1444,  2826.80,  0.491950,  0.086205],
            [1650.00,  11.3970,  10.1010,  1.1555,  3097.70,  0.494640,  0.084173],
            [1675.00,  11.3170,  8.5903,  1.1698,  3331.00,  0.498070,  0.082338],
            [1700.00,  11.2550,  7.3383,  1.1849,  3529.40,  0.502120,  0.080682],
            [1725.00,  11.2070,  6.4221,  1.1986,  3700.80,  0.506560,  0.079173],
            [1750.00,  11.1690,  5.7743,  1.2102,  3852.80,  0.511230,  0.077779],
            [1775.00,  11.1390,  5.3118,  1.2195,  3991.00,  0.516020,  0.076479],
            [1800.00,  11.1150,  4.9742,  1.2270,  4119.40,  0.520870,  0.075254],
            [1825.00,  11.0960,  4.7228,  1.2328,  4240.50,  0.525750,  0.074093],
            [1850.00,  11.0800,  4.5331,  1.2375,  4356.00,  0.530630,  0.072986],
            [1875.00,  11.0660,  4.3894,  1.2410,  4467.50,  0.535520,  0.071926],
            [1900.00,  11.0550,  4.2810,  1.2435,  4575.80,  0.540400,  0.070908],
            [1925.00,  11.0460,  4.2004,  1.2453,  4681.80,  0.545280,  0.069927],
            [1950.00,  11.0380,  4.1422,  1.2463,  4786.00,  0.550150,  0.068980],
            [1975.00,  11.0310,  4.1025,  1.2468,  4889.00,  0.555010,  0.068063],
            [2000.00,  11.0240,  4.0784,  1.2467,  4991.30,  0.559860,  0.067174],
            [2025.00,  11.0190,  4.0675,  1.2462,  5093.10,  0.564710,  0.066311],
            [2050.00,  11.0130,  4.0684,  1.2452,  5194.70,  0.569550,  0.065471],
            [2075.00,  11.0090,  4.0797,  1.2439,  5296.60,  0.574370,  0.064654],
            [2100.00,  11.0040,  4.1006,  1.2423,  5398.80,  0.579200,  0.063857],
            [2125.00,  10.9990,  4.1304,  1.2404,  5501.70,  0.584010,  0.063080],
            [2150.00,  10.9950,  4.1688,  1.2382,  5605.40,  0.588820,  0.062321],
            [2175.00,  10.9900,  4.2154,  1.2358,  5710.20,  0.593630,  0.061579],
            [2200.00,  10.9860,  4.2703,  1.2332,  5816.20,  0.598430,  0.060852],
            [2225.00,  10.9810,  4.3333,  1.2305,  5923.80,  0.603230,  0.060141],
            [2250.00,  10.9750,  4.4046,  1.2276,  6033.00,  0.608020,  0.059444],
            [2275.00,  10.9700,  4.4843,  1.2245,  6144.10,  0.612810,  0.058761],
            [2300.00,  10.9630,  4.5727,  1.2214,  6257.30,  0.617610,  0.058090],
            [2325.00,  10.9570,  4.6701,  1.2181,  6372.80,  0.622400,  0.057431],
            [2350.00,  10.9500,  4.7768,  1.2148,  6490.80,  0.627190,  0.056783],
            [2375.00,  10.9420,  4.8932,  1.2114,  6611.70,  0.631980,  0.056145],
            [2400.00,  10.9340,  5.0198,  1.2080,  6735.60,  0.636780,  0.055517],
            [2425.00,  10.9240,  5.1568,  1.2046,  6862.80,  0.641580,  0.054899],
            [2450.00,  10.9140,  5.3049,  1.2012,  6993.50,  0.646380,  0.054288],
            [2475.00,  10.9030,  5.4645,  1.1978,  7128.10,  0.651200,  0.053686],
            [2500.00,  10.8910,  5.6362,  1.1944,  7266.90,  0.656020,  0.053091],
            [2525.00,  10.8780,  5.8205,  1.1911,  7410.00,  0.660850,  0.052503],
            [2550.00,  10.8640,  6.0179,  1.1878,  7558.00,  0.665690,  0.051921],
            [2575.00,  10.8490,  6.2291,  1.1846,  7711.00,  0.670540,  0.051344],
            [2600.00,  10.8320,  6.4546,  1.1815,  7869.60,  0.675410,  0.050773],
            [2625.00,  10.8140,  6.6951,  1.1785,  8033.90,  0.680290,  0.050206],
            [2650.00,  10.7950,  6.9512,  1.1755,  8204.40,  0.685190,  0.049643],
            [2675.00,  10.7740,  7.2236,  1.1727,  8381.60,  0.690110,  0.049084],
            [2700.00,  10.7520,  7.5128,  1.1700,  8565.80,  0.695050,  0.048528],
            [2725.00,  10.7270,  7.8198,  1.1675,  8757.40,  0.700010,  0.047974],
            [2750.00,  10.7010,  8.1450,  1.1650,  8956.90,  0.705000,  0.047423],
            [2775.00,  10.6740,  8.4893,  1.1627,  9164.80,  0.710020,  0.046873],
            [2800.00,  10.6440,  8.8535,  1.1604,  9381.50,  0.715060,  0.046325],
            [2825.00,  10.6120,  9.2382,  1.1584,  9607.60,  0.720130,  0.045778],
            [2850.00,  10.5780,  9.6443,  1.1564,  9843.60,  0.725240,  0.045231],
            [2875.00,  10.5420,  10.0730,  1.1546,  10090.00,  0.730390,  0.044685],
            [2900.00,  10.5030,  10.5240,  1.1528,  10347.00,  0.735570,  0.044138],
            [2925.00,  10.4630,  10.9990,  1.1512,  10616.00,  0.740790,  0.043591],
            [2950.00,  10.4190,  11.4980,  1.1497,  10898.00,  0.746060,  0.043043],
            [2975.00,  10.3740,  12.0230,  1.1484,  11192.00,  0.751370,  0.042494],
            [3000.00,  10.3250,  12.5730,  1.1471,  11499.00,  0.756720,  0.041943],
            [3025.00,  10.2740,  13.1510,  1.1460,  11820.00,  0.762130,  0.041391],
            [3050.00,  10.2210,  13.7550,  1.1449,  12157.00,  0.767590,  0.040838],
            [3075.00,  10.1640,  14.3870,  1.1440,  12508.00,  0.773100,  0.040282],
            [3100.00,  10.1050,  15.0470,  1.1432,  12876.00,  0.778670,  0.039724],
            [3125.00,  10.0430,  15.7340,  1.1424,  13261.00,  0.784290,  0.039164],
            [3150.00,  9.9779,  16.4490,  1.1418,  13663.00,  0.789980,  0.038602],
            [3175.00,  9.9101,  17.1900,  1.1413,  14084.00,  0.795720,  0.038038],
            [3200.00,  9.8394,  17.9570,  1.1408,  14523.00,  0.801520,  0.037471],
            [3225.00,  9.7658,  18.7470,  1.1405,  14982.00,  0.807380,  0.036903],
            [3250.00,  9.6894,  19.5580,  1.1402,  15460.00,  0.813290,  0.036333],
            [3275.00,  9.6103,  20.3880,  1.1401,  15960.00,  0.819260,  0.035761],
            [3300.00,  9.5285,  21.2320,  1.1400,  16480.00,  0.825280,  0.035188],
            [3325.00,  9.4442,  22.0860,  1.1400,  17021.00,  0.831340,  0.034614],
            [3350.00,  9.3574,  22.9440,  1.1401,  17584.00,  0.837430,  0.034040],
            [3375.00,  9.2684,  23.8020,  1.1403,  18169.00,  0.843560,  0.033467],
            [3400.00,  9.1774,  24.6530,  1.1406,  18774.00,  0.849690,  0.032894],
            [3425.00,  9.0845,  25.4890,  1.1409,  19401.00,  0.855830,  0.032323],
            [3450.00,  8.9899,  26.3050,  1.1414,  20049.00,  0.861950,  0.031755],
            [3475.00,  8.8941,  27.0930,  1.1419,  20716.00,  0.868040,  0.031191],
            [3500.00,  8.7971,  27.8450,  1.1425,  21403.00,  0.874080,  0.030630],
            [3525.00,  8.6994,  28.5570,  1.1432,  22108.00,  0.880050,  0.030075],
            [3550.00,  8.6012,  29.2200,  1.1439,  22830.00,  0.885930,  0.029526],
            [3575.00,  8.5028,  29.8310,  1.1447,  23569.00,  0.891710,  0.028985],
            [3600.00,  8.4046,  30.3850,  1.1456,  24322.00,  0.897350,  0.028451],
            [3625.00,  8.3067,  30.8770,  1.1465,  25087.00,  0.902850,  0.027925],
            [3650.00,  8.2095,  31.3050,  1.1474,  25865.00,  0.908180,  0.027410],
            [3675.00,  8.1133,  31.6670,  1.1484,  26652.00,  0.913320,  0.026904],
            [3700.00,  8.0183,  31.9610,  1.1495,  27448.00,  0.918280,  0.026410],
            [3725.00,  7.9248,  32.1880,  1.1506,  28250.00,  0.923030,  0.025926],
            [3750.00,  7.8329,  32.3470,  1.1517,  29056.00,  0.927560,  0.025455],
            [3775.00,  7.7428,  32.4410,  1.1529,  29866.00,  0.931870,  0.024995],
            [3800.00,  7.6547,  32.4700,  1.1541,  30678.00,  0.935970,  0.024548],
            [3825.00,  7.5687,  32.4370,  1.1553,  31489.00,  0.939840,  0.024114],
            [3850.00,  7.4850,  32.3460,  1.1565,  32299.00,  0.943490,  0.023692],
            [3875.00,  7.4036,  32.1980,  1.1578,  33106.00,  0.946930,  0.023284],
            [3900.00,  7.3246,  31.9980,  1.1591,  33909.00,  0.950160,  0.022887],
            [3925.00,  7.2480,  31.7500,  1.1604,  34706.00,  0.953200,  0.022504],
            [3950.00,  7.1740,  31.4580,  1.1617,  35496.00,  0.956060,  0.022133],
            [3975.00,  7.1025,  31.1260,  1.1630,  36278.00,  0.958740,  0.021775],
        ])

        self._data = gas

    def gas_enthalpy(idx, T):

        aux = idx + 1

        dx = table[aux+1, 0] - table[aux, 0]
        dy = table[aux+1, 4] - table[aux, 4]

        return (table[aux, 4] + dy/dx*(temperature - table[aux, 0]))*1000.0

    def gas_heat_capacity(idx, temperature):

        aux = idx + 1

        dx = table[aux+1, 0] - table[aux, 0]
        dy = table[aux+1, 2] - table[aux, 2]

        return (table[aux, 2] + dy/dx*(temperature - table[aux, 0]))*1000.0

    def gas_molar_mass(idx, temperature):

        aux = idx + 1

        dx = table[aux+1, 0] - table[aux, 0]
        dy = table[aux+1, 1] - table[aux, 1]

        return table[aux, 1] + dy/dx*(temperature - table[aux, 0])

    def gas_dMdT(idx, temperature):

        aux = idx + 1

        dx = table[aux+1, 0] - table[aux, 0]
        dy = table[aux+1, 1] - table[aux, 1]

        return dy/dx

    def gas_viscosity(self, idx, temperature):

        table = self._data

        dx = table[idx+1, 0] - table[idx, 0]
        dy = table[idx+1, 5] - table[idx, 5]

        return (table[idx, 5] + dy/dx*(temperature - table[idx, 0]))*1.0e-4
